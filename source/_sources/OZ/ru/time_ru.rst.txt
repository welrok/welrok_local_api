Время
~~~~~~~~~~

Для получения значения текущих параметров времени устройства, используйте запрос ``{"cmd":3}`` `команды <commands_ru.html>`_.

Для изменения времени и часового пояса на устройстве отправьте запрос

.. code-block:: json

   {
      "sn":"404CCAAAD4E8A89860609800000149",
      "time":"634929122"
      "tzone":"3"
   }

``sn`` - серийный номер устройства

``time`` - время в секундах от 01.01.2000 00:00

``tzone`` - часовой пояс


Для изменения часового пояса без изменения времени

.. code-block:: json

   {
      "sn":"404CCAAAD4E8A89860609800000149",
      "tzone":"3"
   }

Для изменения времени без изменения часового пояса

.. code-block:: json

   {
      "sn":"404CCAAAD4E8A89860609800000149",
      "time":"634929122"
   }

.. note::
   Если включена блокировка изменений по локальной сети (`параметры <parameters_ru.html>`_ ``lanBlock`` 114 = **1**; в меню терморегулятора пункт ``bLc`` = **Lan**) в запрос необходимо внести TOTP токен «auth» (см `безопасность <safety_ru.html>`_)

.. code-block:: json

   {
      "sn":"404CCAAAD4E8A89860609800000149",
      "time":"634929122"
      "tzone":"часовой пояс"
      "auth":"672201707"
   }

.. important::
   При установке времени с разницей, превышающей 24 часа, параметр телеметрии ``f21`` сбрасывается и восстанавливается синхронизация времени с облаком

При установке времени с помощью команды, синхронизация времени устройства и времени на облаке прекращается. Для восстановления синхронизации времени, необходимо произвести сброс настроек устройства по умолчанию (см. инструкцию для устройства)

.. note::

   При установке времени, отстающего от текущего времени на устройстве, может произойти конфликт настроек.

   Конфликт заключается в том, что если были отправлены какие либо команды на устройство через облако и их время будет больше установленного вручную, новые команды не будут выполняться до тех пор, пока на устройстве время не станет больше, чем время последней команды, прошедшей через облако.

   На примере:
   
      * Была отправлена команда на устройство синхронизированное с облаком в 13:00 реального времени. 
      * В 13:01 устанавливается новое время для устройства 10:01.
      * На протяжении 3 часов никакие новые команды не будут проходить.
      * В 16:01 реального времени, когда на устройстве станет 13:01, что будет уже позже чем 13:00, когда сервер увидел последнюю команду, новые команды начнут приниматься и исполняться.
   
   Для предотвращения конфликта можно заранее отключить синхронизацию с облаком (см `безопасность <safety_ru.html>`_).
