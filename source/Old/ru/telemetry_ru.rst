Телеметрия
==========

Телеметрия служит для получения текущего состояния устройства.
Для получения телеметрии отправьте запрос ``{"cmd":4}``. Ответ:

.. code-block:: json 

   {
      "sn":"404CCAAAD4E8A89860609800000149",
      "f.0":"1","f.3":"0","f.4":"0","f.7":"0",
      "f.9":"0","f.10":"0","f.11":"0","f.12":"0",
      "f.13":"0","f.16":"0","f.20":"0","m.0":"0",
      "m.1":"0","m.2":"65","m.3":"2","m.5":"0",
      "o.0":"-57","o.1":"1","par.26":"45","par.27":"5",
      "t.0":"470","t.1":"392","t.5":"400","t.7":"640","time":"812112348"
   }

``sn`` - серийный номер устройства

``x.n`` - ключ параметра, где ``x`` - группа параметров, ``n`` - номер в группе

``time`` - время запроса

Группы параметров:
   * ``t`` - температура в 1/16 °C
      * ``0`` - внутрений датчик перегрева
      * ``1`` - пола
      * ``5`` - текущая уставка
      * ``7`` - температура МК
   * ``m`` - режимы
      * ``0`` - тип контроля: пол = 0, воздух (не используется в этой модели) = 1, расширенный = 2 (не используется в этой модели)
      * ``1`` - тип управления: по расписанию = 0, ручной = 3, отъезд = 4, временный = 5           
      * ``2`` - номер текущего периода расписания (всего в расписании используется 7 дней недели, в каждом из которых может быть до 16 периодов. Соответственно, если в расписании каждый день используется по 16 периодов, то значение может быть от 0, что будет являться первым периодом понедельника, до 111, что будет последним периодом воскресенья. Приведен пример максимально возможного значения. Периодов может быть меньше, например, если используем по 2 периода на каждый день, диапазон значений будет от 0, что будет первым периодом понедельника, до 13, что будет последним периодом воскресенья)
      * ``3`` - тип блокировки: нет блокировок = 0, блокировка изменений из облака = 1, блокировка изменений из локальной сети = 2, обе = 3
      * ``5`` - режим работы нагрева (0 - нагрев, 1 - охлаждение)   
   * ``o`` - прочие параметры
      * ``0`` - уровень сигнала Wi-Fi в dBm (-127..128)
      * ``1`` - причина последней перезагрузки. В зависимости от аппаратной версии платформы может выводиться два типа значений. Первый - маска шестнадцатиричной системы, которые читаются так: выключение = 0x04, программный сброс = 0x08, сторожевой таймер = 0x10, низкое напряжение = 0x40. Второй -  прямое значение: программная перезагрузка из-за низкого напряжения питания МК = 9; программная перезагрузка = 3; сброс питания = 1.
   * ``par`` - дублирование некоторых `параметров <parameters_ru.html>`_ устройства
      * ``n`` - номер параметра   
   * ``f`` - битовые параметры
      * ``0`` - состояние нагрузки: 0 - выключена  1 - включена
      * ``3`` - обрыв датчика пола: 0 - нет обрыва  1 - обрыв
      * ``4`` - короткое замыкания датчика пола: 0 - нет короткого замыкания  1 - короткое замыкание
      * ``7`` - действие предварительного прогрева: 0 - выключен  1 - включен
      * ``9`` - внутренний перегрев: 0 - нет перегрева  1 - перегрев
      * ``10`` - проблема синхронизации времени: 0 - время на терморегуляторе совпадает со временем облака 1 - время на терморегуляторе не совпадает со временем облака.
      * ``11`` - проблема течения времени: 0 - время на терморегуляторе считается верно (не опаздывает)  1 - время на терморегуляторе считается неверно (опаздывает)
      * ``12`` - контроль перегрева (цепь внутреннего датчика контроля температуры устройства): 0 нет ошибки (работает корректно), 1 - ошибка (не работает контроль перегрева)
      * ``13`` - пропорциональный режим работы нагрузки (аварийный режим работы без датчика температуры пола): 0 - выключен  1 - включен
      * ``14`` - используется цифровой датчик пола: 0 - не используется  1 - используется
      * ``16`` - устройство выключено: 0 - включено 1 - выключено
      * ``20`` - ошибка детектирования цепи контроля перехода синусоиды через ноль: 0 - нет ошибки  1 - ошибка

