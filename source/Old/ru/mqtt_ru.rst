**MQTT**
========

Доступна возможность сбора телеметрии и управление ключевыми параметрами по протоколу MQTT.
Настройки подключения к MQTT серверу доступны только через веб-интерфейс устройства, который доступен по его локальному IP адресу:

``Host``/``Port`` - IP адрес и порт MQTT сервера

``User``/``Password`` - имя пользователя и пароль для подключения к MQTT серверу

``Keep alive`` - максимально допустимый промежуток времени без обмена данными

``QoS`` - уровень качества обслуживания

``Publish prefix`` - префикс публикации для отправки телеметрии

``Subscribe path`` - название пути для подписки на комманды

``Client ID`` - имя устройства

.. note::
   Если на сервере MQTT не настроена авторизация, то поля ``User``/ ``Password`` игнорируются.

.. important::
   Максимальная длина имени ``User`` и ``Password`` составляет 30 символов

.. rubric:: **ПУБЛИКУЮТСЯ ТОПИКИ** 

Раз в минуту, с интервалом +/- 5 секунд, публикуются данные в следующие топики:

``Publish prefix``/``Client ID``/``get``/``floorTemp`` - показания датчика температуры пола, возвращается значение аналогичное `телеметрии <telemetry_ru.html>`_, запрошенной по API по параметру **«t.1»**. Возвращается в °C строкой «xx.x» 

``Publish prefix``/``Client ID``/``get``/``protTemp`` - показания внутреннего датчика перегрева, возвращается значение аналогичное `телеметрии <telemetry_ru.html>`_, запрошенной по API по параметру **«t.0»**. Возвращается в °C строкой «xx.x»

``Publish prefix``/``Client ID``/``get``/``setTemp`` - температура уставки, возвращается значение аналогичное `телеметрии <telemetry_ru.html>`_, запрошенной по API по параметру **«t.5»**. Возвращается в °C строкой «xx.x»

``Publish prefix``/``Client ID``/``get``/``powerOff`` - устройство выключено, возвращается значение аналогичное `телеметрии <telemetry_ru.html>`_, запрошенной по API по параметру **«f.16»**. Возвращается строкой, где «0» - включено, «1» - выключено

``Publish prefix``/``Client ID``/``get``/``load`` - состояние нагрузки, возвращается значение аналогичное `телеметрии <telemetry_ru.html>`_, запрошенной по API по параметру **«f.0»**. Возвращается строкой, где «0» - выключена, «1» - включена

``Publish prefix``/``Client ID``/``get``/``bright`` – текущая яркость экрана терморегулятора, читается аналогично `параметрам <parameters_ru.html>`_, запрошенным по API командой ``{"cmd":1}``

.. rubric:: **ТОПИКИ ДЛЯ УПРАВЛЕНИЯ** 

Доступны следующие топики для управления:

.. note:: 
   После отправки команды управления, через 3-5 секунд происходит внеочередная публикация данных

``Subscribe path``/``Client ID``/``set``/``setTemp`` - установка температуры уставки. Передается строкой в формате «xx»

``Subscribe path``/``Client ID``/``set``/``bright`` - яркость дисплея. Передается строкой в формате «x». Значения от 0 до 9.

``Subscribe path``/``Client ID``/``set``/``powerOff`` - выключение устройства. Передается строкой в формате «x». Значения от 0 или 1, где 0 - включено 1 - выключено

``Subscribe path``/``Client ID``/``set``/``mode`` - выбор режима работы. Передается строкой в формате «x». Значения от 0 или 1, где 0 - расписание, 3 - ручной.

.. note::
   Температура датчика пола в пользовательском меню устройства и через API/MQTT изменяется с шагом в 1 °C во всем рабочем диапазоне.

