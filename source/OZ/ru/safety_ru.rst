Безопасность
~~~~~~~~~~~~

Реализована возможность управления со включенной блокировкой изменений по локальной сети (`параметры <parameters_ru.html>`_ ``lanBlock`` 114 = **1**; в меню терморегулятора пункт ``bLc`` = **Lan**).

.. note::
   Если включены обе блокировки сразу (`параметры <parameters_ru.html>`_ ``lanBlock`` 114 = **1** и ``cloudBlock`` 115 = **1**; пункт меню самого устройства ``bLc`` = **on**), то устройство заблокировано полностью для удаленного управления. Управление возможно только с кнопок.

Для аутентификации источника при отправке команд на устройство используется TOTP протокол (**rfc4226**, **rfc6238**, Interval = 30 second, Digit = 9). 
Для этого необходимо добавить два поля перед полями с данными:

``time`` - время в секундах от 01.01.2000 00:00

``auth`` - вычисленный токен.

Тогда команда, например, для включение устройства, изменение яркости на 1 и включение блокирования изменений по API, будет выглядеть так:

.. code-block:: json

   {
      "sn":"404CCAAAD4E8A89860609800000149",
      "time":"634929122",
      "auth":"672201707",
      "par":[[125,7,"0"], [23,2,"1"], [114,7,"1"]]
   }

Ключ для генерации токена можно получить через `АПИ сервера <keyGet_ru.html>`_.

Если нет необходимости использовать аутентификацию, то для управления по локальной сети необходимо отключить блокировку.

Просмотреть статус блокировки можно в телеметрии - ключ ``m.3``, в настройках - параметр ``lanBlock`` или в меню - пункт ``bLc``.

Отключается блокировка через меню устройства - параметр ``bLc`` надо изменить на **oFF**. 

.. note::
   Краткими нажатиями на среднюю кнопку дойти до раздела меню ``bLc``, после этого кнопками выбора + и - изменить значение на **oFF** (см. инструкцию к устройству).

.. note::
   На устройстве существует страница http://``dev_ip``/index.html``, где доступна функция подключения устройства к облаку ``API`` ``CLOUD``. Если пункт ``CLOUD`` включен, связь устройства с облаком активна. Если пункт ``CLOUD`` выключен, связь устройства с облаком отсутствует. При отключении связи с облаком гарантированно не передаются никакие данные на облако. Однако при этом не осуществляется и синхронизации времени на устройстве с облаком. Страница доступна так-же при работе утройства в режиме точки доступа. Для этого переведите устройство в режим «AP», подключитесь к нему и перейдите по ссылке: http://192.168.0.1/index.html